; ansible "hosts" inventory for {{ env_name }} 
; This is an auto-generated file for this deployment. 

; hosts and groups

; our "management hosts" - these don't actually exist,
;  they are really virtual hosts we use to group variables
localhost ansible_connection=local

[managers]
vpc-manager
{% for zone in zones %}
zone{{ loop.index }}-az-manager
{% set outer_loop = loop %}
{% for apphostnum in range(1, apphosts_per_zone + 1) %}
zone{{ outer_loop.index }}-apphost{{ apphostnum }}-manager
{% endfor %}
{% for bigipnum in range(1, standalone_per_az['bigips_per_zone'] + 1) %}
zone{{ outer_loop.index }}-bigip{{ bigipnum }}-manager
{% endfor %}
{% for gtmnum in range(1, standalone_per_az['gtms_per_zone'] + 1) %}
zone{{ outer_loop.index }}-gtm{{ gtmnum }}-manager
{% endfor %}
{% endfor %}
zone1-clienthost-manager

; dynamic group that we will add to via add_host
[clienthosts]
[apphosts]
[bigips]
[gtms]

{% for zone in zones %}
[zone{{ loop.index }}-clienthosts]
[zone{{ loop.index }}-apphosts]
[zone{{ loop.index }}-bigips]
[zone{{ loop.index }}-gtms]

{% endfor %}

{% for zone in zones %}
[zone{{ loop.index }}:children]
zone{{ loop.index }}-az-managers
zone{{ loop.index }}-clienthosts
zone{{ loop.index }}-apphosts
zone{{ loop.index }}-bigips
zone{{ loop.index }}-gtms

{% endfor %}

{% for zone in zones %}
[zone{{ loop.index }}-az-managers]
zone{{ loop.index }}-az-manager
zone{{ loop.index }}-clienthost-manager
zone{{ loop.index }}-apphost1-manager
zone{{ loop.index }}-bigip1-manager
zone{{ loop.index }}-gtm1-manager

{% endfor %}

[vpc-managers]
vpc-manager

[az-managers]
{% for zone in zones %}
zone{{ loop.index }}-az-manager
{% endfor %}

[apphost-managers]
{% for zone in zones %}
{% set outer_loop = loop %}
{% for apphostnum in range(1, apphosts_per_zone + 1) %}
zone{{ outer_loop.index }}-apphost{{ loop.index }}-manager
{% endfor %}
{% endfor %}

[bigip-managers]
{% for zone in zones %}
{% set outer_loop = loop %}
{% for bigipnum in range(1, standalone_per_az['bigips_per_zone'] + 1) %}
zone{{ outer_loop.index }}-bigip{{ loop.index }}-manager
{% endfor %}
{% endfor %}

[gtm-managers]
{% for zone in zones %}
{% set outer_loop = loop %}
{% for gtmnum in range(1, standalone_per_az['gtms_per_zone'] + 1) %}
zone{{ outer_loop.index }}-gtm{{ loop.index }}-manager
{% endfor %}
{% endfor %}

[clienthost-managers]
zone1-clienthost-manager

; group vars

[all:vars]
env_name={{ env_name }}
deployment_model={{ deployment_model }}
region={{ region }}
vpc_cidr={{ vpc_cidr_prefix }}.0.0/16
key_name={{ key_name }}
bigip_rest_user={{ bigip_rest_user }}
bigip_rest_pass={{ bigip_rest_pass }}

{% for zone in zones %}
[zone{{ loop.index }}:vars]
zone_id=zone{{ loop.index }}
availability_zone={{ zone }}
zone_cidr_prefix="{{ vpc_cidr_prefix }}.{{ loop.index }}"
management_cidr="{{ vpc_cidr_prefix }}.{{ loop.index }}1.0/24"
private_cidr="{{ vpc_cidr_prefix }}.{{ loop.index }}2.0/24"
public_cidr="{{ vpc_cidr_prefix }}.{{ loop.index }}3.0/24"
application_cidr="{{ vpc_cidr_prefix }}.{{ loop.index }}4.0/24"
bigip_version={{ bigip_version }}
bigip_license_throughput={{ bigip_license_throughput }}
bigip_license_model={{ bigip_license_model }}
bigip_license_package={{ bigip_license_package }}
bigip_instance_type={{ bigip_instance_type }}
gtm_version={{ gtm_version }}
gtm_license_throughput={{ gtm_license_throughput }}
gtm_license_model={{ gtm_license_model }}
gtm_license_package={{ gtm_license_package }}
gtm_instance_type={{ gtm_instance_type }}
apphost_instance_type={{ apphost_instance_type }}
clienthost_instance_type={{ clienthost_instance_type }}

{% endfor %}

[localhost:vars]
ansible_connection=local
ansible_python_interpreter="/usr/bin/env python"
